---
import { getPicture } from '@/utils/post/image'
import * as styles from './picture.css'

interface Props {
  src: {
    src: string
    width: number
    height: number
  }
  alt?: string
}

const {
  src: { src, width, height },
  alt
} = Astro.props as Props

const { image, sources, sizes } = await getPicture({ src, width, height })
---

<picture class={styles.main}>
  {sources.map((source) => <source sizes={sizes} {...source} />)}
  <img
    src={image.src}
    width={image.width}
    height={image.height}
    alt={alt}
    sizes={sizes}
    class={styles.image}
    loading="lazy"
    decoding="async"
    style="max-width: 100%; height: auto;"
  />
</picture>
